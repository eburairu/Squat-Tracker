# 要件定義書: ストリーク・シールド (Streak Shield)

## 1. 目的
ユーザーがトレーニングをできない日があっても、獲得したアイテム「シールド」を消費することで連続記録（ストリーク）の途切れを防ぎ、長期的な継続モチベーションを維持する。

## 2. ユーザー価値
- 「1日休んだら記録がゼロになる」という心理的プレッシャーと、失敗時の挫折感を軽減する。
- 継続すること自体に加えて、アイテム収集というRPG的な楽しみを付与する。

## 3. 機能要件

### 3.1 シールド所持・管理
- ユーザーは「ストリーク・シールド」という消費アイテムを所持できる。
- シールドはインベントリ画面で所持数を確認できる。
- （初期フェーズではデバッグ/配布でのみ入手可能とするが、将来的にミッション報酬等で入手可能にする）

### 3.2 自動消費（オート・セーブ）
- アプリ起動時に以下の条件を満たす場合、自動的にシールドを1つ消費する。
  - **条件1**: 前日（Yesterday）のトレーニング記録が存在しない。
  - **条件2**: 前日に対して既にシールドが使用されていない。
  - **条件3**: シールドの所持数が1以上である。
- 消費された場合、前日の日付で「シールド使用履歴」が記録される。
- ユーザーには「シールドを使用して連続記録を守りました！」等の通知（Toast）を表示する。

### 3.3 ストリーク計算への反映
- ストリーク（連続記録日数）の計算ロジックにおいて、実際のトレーニング記録がない日でも「シールド使用履歴」があれば、その日は「継続」とみなす。

### 3.4 エッジケース・制約
- **複数日の欠席**:
  - 今回の仕様では「前日（1日前）」のみを救済対象とする。2日以上連続で休んだ場合、前日は救済されるが、それ以前の欠席によりストリークは途切れる可能性がある。（実装の複雑さを避けるため）
  - ただし、ロジック上は「過去の欠席日全てに対してシールドがあれば埋める」ことも可能だが、ユーザーが予期せぬ大量消費を防ぐため、まずは「直近の欠席のみ」または「起動時にチェックして1つだけ使う」挙動とする。
  - **決定**: アプリ起動時にチェックするのは「昨日」のみとする。

- **在庫ゼロ**:
  - シールドがない場合は救済されず、通常通りストリークはリセットされる。

## 4. UI/UX
- **インベントリ**: 武器リストとは別に、あるいは並列して「消費アイテム」セクション、または武器リストの中に「シールド」を表示する。
- **通知**: 自動消費時に音と共に通知を表示。
- **バッジ/表示**: 実績画面やヘッダーのストリーク数は、シールドによる維持を含んだ数値を表示する。

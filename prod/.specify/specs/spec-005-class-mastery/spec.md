# 仕様書: クラス・マスタリー（熟練度）システム

## 1. 概要
ユーザーが特定のクラス（職業）を継続的に使用することで「熟練度（EXP）」が蓄積され、クラスレベル（Lv）が上昇するシステムを導入する。レベルが上がると、そのクラス固有のボーナス効果（攻撃倍率、クイズ倍率など）が強化される。

## 2. 目的
*   **継続率向上**: レベルアップという短期〜中期の目標を提供し、毎日のトレーニングのモチベーションを高める。
*   **多様性の促進**: 初期クラス（冒険者）でも使い込めば強力になるため、プレイスタイルの幅が広がる。
*   **愛着形成**: クラスに対する愛着を深める。

## 3. 機能要件

### 3.1 経験値 (EXP) 獲得
*   トレーニング完了時、実施したスクワット回数（Reps）と同じ値のEXPを獲得する。
*   EXPはクラスごとに個別に蓄積される。
*   獲得時、レベルアップした場合はトースト通知で祝福する。

### 3.2 レベル (Lv) システム
*   累積EXPに基づいてレベルが決定される。
*   最大レベルは **10** とする（拡張性のため）。
*   **必要EXPテーブル (仮)**:
    *   Lv1: 0 EXP
    *   Lv2: 100 EXP
    *   Lv3: 300 EXP (+200)
    *   Lv4: 600 EXP (+300)
    *   Lv5: 1000 EXP (+400)
    *   以降、Lvごとに必要EXPが100ずつ増加。

### 3.3 レベルボーナス
*   クラス定義にある `modifiers` に対して、レベルに応じた倍率を掛ける、または加算する。
*   **ボーナス計算式**:
    *   攻撃倍率 (`attackMultiplier`): `Base + (Lv - 1) * 0.05`
    *   クイズ倍率 (`quizMultiplier`): `Base + (Lv - 1) * 0.1`
    *   クリティカル率 (`criticalRateBonus`): `Base + (Lv - 1) * 0.01` (1%)
*   例: 戦士 (Base 1.2) が Lv5 になると `1.2 + 0.2 = 1.4` 倍。

### 3.4 UI表示
*   **クラス選択画面**:
    *   各クラスカードに現在のレベルバッジを表示。
    *   次のレベルまでの進捗バーを表示。
    *   現在のボーナス値（補正後）を表示。
*   **HUD (常時表示部)**:
    *   クラスアイコンの横などにレベルを小さく表示（スペースがあれば）。

## 4. データ永続化
*   `localStorage` キー: `squat-tracker-class-mastery`
*   フォーマット: JSON `{ "warrior": 1500, "mage": 300 }` (ClassID: TotalEXP)

## 5. エッジケース
*   クラスデータが存在しない場合（削除されたクラスなど）: 無視してエラーにならないようにする。
*   EXPが上限を超えた場合: カンスト表示（MAX）とする。

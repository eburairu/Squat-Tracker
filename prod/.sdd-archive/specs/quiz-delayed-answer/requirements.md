# 要件定義書

## 機能概要
計算問題（クイズ）において、ユーザーが回答を選択してから答え合わせが行われるまでの挙動を変更する。
具体的には、即時判定を廃止し、フェーズが「回答表示（UP）」になるまで判定を遅延させる。その間は回答の再選択を可能とする。

## ユーザーストーリー
- ユーザーとして、間違ってボタンを押してしまった時に修正したい。なぜなら、スクワット中に指が滑ることがあるから。
- ユーザーとして、答え合わせのタイミングを明確にしたい。なぜなら、いつ結果が確定したのか分かりやすくするため。

## 機能要件

### 要件1：回答選択の遅延判定
- 詳細説明
    - クイズの選択肢ボタンを押した時点では、その選択肢を「選択状態」としてマークするのみとする。
    - 「選択状態」のボタンは視覚的に区別（ハイライト）する。
    - 別の選択肢を押した場合は、新しい選択肢が「選択状態」となり、前の選択は解除される。
    - この時点では正解・不正解の音やエフェクトは発生させない。
- 受入基準：
    - [ ] ボタンを押すと選択状態（スタイル変更）になること。
    - [ ] 別のボタンを押すと選択が切り替わること。
    - [ ] UPフェーズになるまで正誤判定（トースト、SE、エフェクト）が発生しないこと。

### 要件2：正誤判定の実行
- 詳細説明
    - フェーズが `DOWN` または `HOLD` から `UP` に切り替わったタイミングで、現在選択されている回答に対して正誤判定を行う。
    - 正解の場合：正解エフェクト、攻撃ボーナスなどを適用。
    - 不正解の場合：不正解エフェクト、ペナルティなどを適用。
    - 未選択の場合：不正解として扱う。
- 受入基準：
    - [ ] UPフェーズ遷移時に正誤判定が行われること。
    - [ ] 正解を選択していた場合、正解として処理されること（緑色表示、SE、ボーナス）。
    - [ ] 不正解を選択していた場合、不正解として処理されること（赤色表示、SE、ペナルティ）。
    - [ ] 何も選択していなかった場合、不正解として処理されること。

### 要件3：回答ボタンの表示レイアウト
- 詳細説明
    - 回答ボタンは常に 1x4 のレイアウトで表示する（現状のCSSを維持・修正）。
    - フェーズに関わらずレイアウトが崩れないこと。
- 受入基準：
    - [ ] 常にボタンが横一列（または意図した1x4グリッド）で表示されること。

## 非機能要件
- 既存のクイズ生成ロジックや攻撃計算ロジックに影響を与えないこと。

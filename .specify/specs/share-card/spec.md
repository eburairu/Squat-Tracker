# 機能仕様書: 戦績シェアカード生成機能

**機能ID**: `share-card-generator`
**作成日**: 2024-05-23
**ステータス**: Draft

## 1. 概要
トレーニング完了時（リザルト画面）に、その日の成果や現在のRPGステータス（武器・称号・ボス）を統合した「戦績カード」を画像として生成・ダウンロードできる機能を提供する。これにより、ユーザーは自身の努力を視覚的にSNS等で共有できるようになる。

## 2. ユーザーストーリー
- **US-001**: ユーザーは、日々の激しいトレーニングの成果を、単なる数字だけでなく「倒したボス」や「手に入れたレア武器」と共に画像として保存したい。
- **US-002**: ユーザーは、作成された画像をX (Twitter) やInstagramに投稿し、友人やフォロワーからの承認を得ることで、次回のモチベーションに繋げたい。

## 3. 機能要件 (Functional Requirements)

### FR-01: シェアトリガー
- トレーニング完了画面（`WorkoutTimer` のリザルト表示）に「シェア画像を作成」ボタンを配置する (MUST)。
- このボタンはトレーニング完了時のみ表示される (MUST)。

### FR-02: プレビューモーダル
- ボタン押下時にモーダルウィンドウを開き、生成される画像のプレビューを表示する (MUST)。
- モーダルには「画像を保存」ボタンと「閉じる」ボタンを配置する (MUST)。

### FR-03: 戦績カードの内容
画像化されるカードには以下の情報を含める (MUST):
1. **ヘッダー**: アプリ名（Squat Quest / Squat Tracker）と日付。
2. **リザルト**: 当該セッションの合計スクワット回数、消費カロリー。
3. **RPGステータス**:
    - 現在装備している武器（アイコン、名称、レアリティ）。
    - 現在設定している称号。
    - 現在戦っている（または倒した）ボスの画像と名前。
4. **フッター**: アプリのURLまたはQRコード（今回はURL表記とする）。

### FR-04: 画像生成と保存
- 「画像を保存」ボタン押下時に、プレビュー内容を画像（PNG形式）に変換し、ブラウザのダウンロード機能を通じて保存する (MUST)。
- ファイル名は `squat-record-YYYYMMDD-HHMM.png` の形式とする (SHOULD)。

## 4. 非機能要件 (Non-Functional Requirements)

- **NFR-01 (Performance)**: 画像生成処理は、ボタン押下から3秒以内に完了すること。
- **NFR-02 (Compatibility)**: PCおよび主要なモバイルブラウザ（Chrome, Safari）でレイアウト崩れなく動作すること。
- **NFR-03 (Privacy)**: 画像生成はクライアントサイド（ブラウザ内）で完結し、サーバーへ画像をアップロードしないこと。

## 5. UI/UX仕様

### レイアウトイメージ
```
+-----------------------------------+
|  [Logo]  2024.05.23               |
+-----------------------------------+
|        150 Reps  45 kcal          |
+-----------------------------------+
|  [Boss Image]                     |
|  Vs. ドラゴン (HP: 50/150)        |
+-----------------------------------+
|  Weapon: 🗡️ エクスカリバー       |
|  Title:  不屈の 勇者              |
+-----------------------------------+
|  Squat Tracker                    |
+-----------------------------------+
```
背景色はダークテーマを基調とし、文字は白またはゴールドとする。

## 6. エッジケース
- **武器未所持**: 初期装備（素手）または「なし」を表示。
- **ボス不在**: アドベンチャーモードの背景、または汎用シルエットを表示。
- **画像生成失敗**: エラーをトースト通知で表示し、ユーザーにリトライを促す。

# Boss Battle Progression & Regeneration

## 概要
ボスバトル機能を強化し、ユーザーの継続的なトレーニングを動機づけるシステムへと進化させる。
ランダム出現だったモンスターを固定順のプログレッションに変更し、周回要素と放置時のHP回復（ペナルティ）を導入する。
また、スクワット回数とダメージを連動させ、トレーニングの成果を即座にフィードバックする。

## 要件

### 1. モンスター出現ロジック (Progression)
- **固定順序**: モンスターは以下の定義順に出現する。
    1. スライム
    2. コウモリ
    3. ゴースト
    4. ゴブリン
    5. スケルトン
    6. オーク
    7. 宇宙人
    8. ロボット
    9. 恐竜
    10. ドラゴン
- **初期状態**: 初回プレイ時またはデータリセット時は「スライム」から開始する。

### 2. 周回システム (Loop & Scaling)
- **ループ**: 最後のモンスター（ドラゴン）を倒すと、次の出現モンスターは再び最初の「スライム」となる。
- **HPスケーリング**: 周回数に応じてモンスターの最大HPが増加する。
    - 1周目: 1.0倍 (基本値)
    - 2周目: 1.5倍
    - 3周目以降: `1 + (周回数 - 1) * 0.5` 倍（例: 3周目=2.0倍, 4周目=2.5倍...）
- **表示**: 周回数はUIには明示しなくても良いが、HPバーの最大値が増えることで強さを表現する。

### 3. HP自動回復 (Regeneration)
- **放置ペナルティ**: 最後のインタラクション（ダメージを与えた、またはゲームを開いた）から時間が経過すると、モンスターのHPが回復する。
- **回復量**: 24時間で最大HPの10%が回復するレートとする。
    - 計算式: `回復量 = 最大HP * 0.1 * (経過時間(ms) / 24時間(ms))`
    - 上限: 現在のHPは最大HPを超えない。
- **タイミング**: アプリ起動時（`init`）およびバックグラウンド復帰時に再計算して適用する。

### 4. 戦闘連携 (Battle Integration)
- **ダメージ計算**: スクワット1回（1 Rep）完了ごとに、モンスターに **1ダメージ** を与える。
- **適用タイミング**:
    - 通常モード: カウントアップ時（Rep完了時）。
    - センサーモード: 深さ検知によるカウントアップ時。
- **撃破処理**:
    - HPが0になった瞬間に撃破演出を行い、即座に次のモンスターを出現させる（オーバーキル分のダメージは切り捨てでよい）。

### 5. データ保存 (Persistence)
- 以下の状態を追加で保存する：
    - `monsterIndex`: 現在のモンスターのインデックス (0-9)
    - `loopCount`: 現在の周回数 (初期値 1)
    - `lastInteraction`: 最後にHP計算やダメージ適用を行った時刻 (Timestamp)

## 受け入れ基準 (Acceptance Criteria)
1. **順序**: スライムを倒すと次はコウモリが出現すること。
2. **周回**: ドラゴンを倒すと次は強化されたスライムが出現すること。
3. **連携**: スクワットを完了するとHPバーが減ること。
4. **回復**: 時間を空けてリロードすると、HPが少し増えていること。

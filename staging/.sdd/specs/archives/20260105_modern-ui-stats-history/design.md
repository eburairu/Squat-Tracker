# 技術設計書

## アーキテクチャ概要

ブラウザで完結する静的Webアプリに、UI刷新、統計表示、履歴保存の機能を追加する。既存のHTML/CSS/JavaScript構成のまま、UIはHTML/CSSの再設計、統計と履歴はJavaScriptでローカル保存（例: localStorage）に統合する。

## 主要コンポーネント

### コンポーネント1：UIレイアウト/スタイル

- 責務：ネイティブアプリ風のレイアウト、タイポグラフィ、配色、レスポンシブ対応を提供する。
- 入力：HTML構造、UI状態（進捗/統計）
- 出力：視覚的に整ったUI
- 依存関係：`index.html`、`styles.css`、進捗/統計データ

### コンポーネント2：統計表示ロジック

- 責務：セッション進捗と保存済み実績を集計し、UIに表示する。
- 入力：現在のセット/回数、保存済み履歴
- 出力：表示用の統計値（例：累計回数、直近実績）
- 依存関係：履歴保存コンポーネント、`app.js` の状態管理

### コンポーネント3：履歴保存

- 責務：トレーニング完了時に実績を保存し、起動時に読み出す。
- 入力：完了時の実績データ
- 出力：保存済み履歴データ
- 依存関係：`app.js` の完了処理、ブラウザのローカルストレージ

## データモデル

### WorkoutHistoryEntry

- id：string、ユニークID
- date：string、実行日（ISO形式）
- totalSets：number、セット数
- repsPerSet：number、1セットの回数
- totalReps：number、総回数
- durations：object、フェーズ秒数（down/hold/up/rest/countdown）

### WorkoutStats

- totalRepsAllTime：number、累計回数
- lastWorkoutDate：string、直近実績日
- lastWorkoutTotalReps：number、直近の総回数

## 処理フロー

1. 起動時にローカルストレージから履歴を読み込み、統計を計算して表示する。
2. トレーニング開始後、進捗（セット/回数）をリアルタイムに更新する。
3. トレーニング完了時に実績を履歴へ追加し、保存と統計更新を行う。

## エラーハンドリング

- ローカルストレージが利用できない場合：履歴保存を無効化し、統計はセッション内のみ表示する。
- 保存データの形式不正：該当データを破棄して初期化する。

## 既存コードとの統合

- 変更が必要なファイル：
    - `index.html`：統計表示領域の追加、レイアウト更新
    - `styles.css`：モダンUIのスタイル定義
    - `app.js`：履歴保存と統計計算ロジックの追加
- 新規作成ファイル：
    - なし
